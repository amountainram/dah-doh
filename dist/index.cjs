"use strict";var y=Object.defineProperty;var j=(e,t,r)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var f=(e,t,r)=>(j(e,typeof t!="symbol"?t+"":t,r),r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const v=({data:e})=>e,m=e=>v(e).split(" "),w=({Answer:e=[]})=>e.map(v),b=({Answer:e=[]})=>e.map(t=>[v(t)]),E=["issue","issuewild","iodef","contactemail","contactphone"],$=(e,t,r,n)=>{if(r===0)return e.critial=Number.parseInt(t),e;if(r%2===1)return e;const s=n[r-1],o=JSON.parse(t);return E.includes(s)&&(e[s]=o),e},N=({Answer:e=[]})=>e.map(t=>m(t).reduce($,{})),P=(e,t,r)=>{switch(r){case 0:e.priority=Number.parseInt(t);break;case 1:e.exchange=t;break}return e},R=({Answer:e=[]})=>e.map(t=>m(t).reduce(P,{})),I=(e,t,r)=>{switch(r){case 0:e.nsname=t;break;case 1:e.hostmaster=t;break;case 2:e.serial=Number.parseInt(t);break;case 3:e.refresh=Number.parseInt(t);break;case 4:e.retry=Number.parseInt(t);break;case 5:e.expire=Number.parseInt(t);break;case 6:e.minttl=Number.parseInt(t);break}return e},M=({Answer:e=[]})=>e.map(t=>m(t).reduce(I,{}))[0],T=(e,t,r)=>{switch(r){case 0:e.priority=Number.parseInt(t);break;case 1:e.weight=Number.parseInt(t);break;case 2:e.port=Number.parseInt(t);break;case 3:e.name=t;break}return e},C=({Answer:e=[]})=>e.map(t=>m(t).reduce(T,{})),D=e=>e,X=e=>typeof e=="string"&&Object.values(i).includes(e);var i=(e=>(e.A="A",e.AAAA="AAAA",e.CNAME="CNAME",e.CAA="CAA",e.MX="MX",e.NS="NS",e.SOA="SOA",e.SRV="SRV",e.TXT="TXT",e))(i||{}),g=(e=>(e.JSON="application/json",e.DNSJSON="application/dns-json",e))(g||{});const k=Object.values(g),d={server:"dns.google/resolve",protocol:"https",fetch:{method:"GET",headers:{accept:"application/json"}}},x={"dns.google/resolve":{headers:{accept:"application/json"}},"cloudflare-dns.com/dns-query":{headers:{accept:"application/dns-json"}}},J=e=>{var n,s;const t=e.server??d.server,r=x[t];return{protocol:e.protocol??d.protocol,server:e.server??d.server,fetch:{...r,...e,method:((n=e.fetch)==null?void 0:n.method)??d.fetch.method,headers:((s=e.fetch)==null?void 0:s.headers)??d.fetch.headers}}},L=e=>e.split(";")[0],O=async(e,t)=>globalThis.fetch(e,t).then(r=>r.ok?r:Promise.reject(new TypeError(`Cannot ${t.method} ${e.href}: ${r.status} ${r.statusText}`))).then(r=>{const n=r.headers.get("content-type");return n&&k.includes(L(n))?r.json():Promise.reject(new TypeError("Wrong content-type header"))}).then(r=>D(r)).then(r=>"error"in r?Promise.reject(new TypeError(r.message)):r);async function A(e,t,r){var u;const{protocol:n,fetch:s,server:o}=J(r??d),{protocol:c}=((u=o.match(/^(<?protocol>[^:]+):\/\//))==null?void 0:u.groups)??{},a=c!==void 0?o:`${n}://${o}`;try{const h=new URL(a);return h.searchParams.set("name",e),t!=="A"&&h.searchParams.set("type",t),O(h,s)}catch{return Promise.reject(new TypeError(`Cannot create a URL from ${a}`))}}async function l(e,t,r){let n=r,s="A";typeof t=="object"&&(n=t),t&&typeof t!="object"&&(s=t);let o;switch(s){case"MX":o=R;break;case"SOA":o=M;break;case"SRV":o=C;break;case"TXT":o=b;break;case"CAA":o=N;break;case"A":case"AAAA":case"CNAME":case"NS":default:o=w;break}return A(e,s,n).then(o)}class V extends Error{constructor(r,n){super(r);f(this,"errno");f(this,"code");f(this,"hostname");f(this,"syscall");this.errno=n==null?void 0:n.errno,this.code=n==null?void 0:n.code,this.hostname=n==null?void 0:n.hostname,this.syscall=n==null?void 0:n.syscall}}function q(e,t,r){const n=typeof t=="function"?t:r,s=typeof t=="function"||!X(t)?void 0:t;(s!==void 0?l(e,s):l(e)).then(c=>n==null?void 0:n(null,c)).catch(c=>n==null?void 0:n(c))}const S=(e,t)=>{const r="ENODATA",n=`query${t}`;return Promise.reject(new V(`${n} ${r} ${e}`,{errno:void 0,code:r,syscall:n,hostname:e}))},p=(e,t,r,n)=>s=>{var c;if(((c=s.Answer)==null?void 0:c[0])===void 0)return S(e,t);const{Answer:o}=s;if(typeof r!="function"&&r.ttl===!0){const a=o.map(({TTL:u,data:h})=>({ttl:u,address:h}));n==null||n(null,a)}else{const a=o.map(u=>u.data);r==null||r(null,a)}return Promise.resolve()};function U(e,t,r){const n=A(e,i.A),s=typeof t=="function"?t:r;n.then(p(e,i.A,t,r)).catch(o=>s==null?void 0:s(o,[]))}function G(e,t,r){const n=i.AAAA,s=A(e,n),o=p(e,n,t,r),c=typeof t=="function"?t:r;s.then(o).catch(a=>c==null?void 0:c(a,[]))}function H(e,t){const r=i.CNAME,n=A(e,r),s=p(e,r,t),o=c=>t(c,[]);n.then(s).catch(o)}function K(e,t){const r=i.CAA,n=A(e,r),s=c=>{var a;((a=c.Answer)==null?void 0:a[0])===void 0&&S(e,r),t(null,N(c))},o=c=>t(c,[]);n.then(s).catch(o)}const W={resolve:l};exports.promises=W;exports.resolve=q;exports.resolve4=U;exports.resolve6=G;exports.resolveCaa=K;exports.resolveCname=H;
